<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Community Resource Hub</title>
  <style>
    :root {
      --bg-color: #FAFAFA;
      --text-color: #333333;
      --accent-blue: #C4D7F2;
      --accent-pink: #F5B6C3;
      --table-stripe: #ffe8ecd4;
      --border-color: #E5E5E5;
    }

    body {
      font-family: "Poppins", "Segoe UI", Arial, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      margin: 0;
      padding: 0;
    }

    header {
      text-align: center;
      background-color: var(--accent-blue);
      color: white;
      padding: 2rem 1rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    header h1 {
      margin: 0;
      font-size: 2rem;
    }

    header p {
      margin: 0.5rem 0 0;
      font-size: 1rem;
    }

    main {
      padding: 2rem;
      max-width: 1100px;
      margin: auto;
    }

    section {
      margin-bottom: 2.5rem;
    }

    .section-header {
      background-color: var(--accent-blue);
      color: white;
      width: 100vw;
      max-width: 100vw;
      margin-left: calc(50% - 50vw);
      padding: 0.75rem 1rem;
      border-radius: 8px 8px 0 0;
      font-weight: 600;
      letter-spacing: 0.5px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

     table {
      /* make tables full-bleed like the search bar */
      width: 100vw;
      max-width: 100vw;
      margin-left: calc(50% - 50vw);
      border-collapse: collapse;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      border-radius: 0 0 8px 8px;
      overflow: hidden;
    }
    th, td {
      padding: 0.75rem 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
    }

    th {
      background-color: var(--accent-pink);
      color: white;
      font-weight: 600;
      text-transform: uppercase;
      font-size: 0.85rem;
      letter-spacing: 0.5px;
    }

    tr:nth-child(even) {
      background-color: var(--table-stripe);
    }

    tr:hover {
      background-color: var(--accent-blue);
      color: white;
      transition: background-color 0.2s ease;
    }
    .search-container {
      display: flex;
      gap: .5rem;
      align-items: center;
      margin: 1rem 0 2rem;
    }

    .search-input {
      flex: 1 1 auto;
      padding: .6rem .75rem;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 1rem;
      outline: none;
      background: white;
    }

    .search-input:focus {
      box-shadow: 0 0 0 3px rgba(196,215,242,0.35);
      border-color: var(--accent-blue);
    }

    .search-clear {
      background: var(--accent-pink);
      color: white;
      border: none;
      padding: .6rem .9rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
    }
 /* subtitle for contact / correction info */
   .contact-subtitle {
     max-width: 1100px;
     margin: 0.5rem auto 1.25rem;
     padding: 0.5rem 1rem;
     color: #2f2f2f;
     font-size: 0.95rem;
     line-height: 1.3;
     text-align: center;
     background: rgba(255,255,255,0.6);
     border-left: 4px solid var(--accent-pink);
     border-radius: 8px;
     box-shadow: 0 1px 2px rgba(0,0,0,0.03);
   }
   .contact-subtitle a {
     color: #0b66a3;
     font-weight: 600;
          text-decoration: underline;
     text-decoration: underline;
   }
 @media (max-width: 1000px) {
      .search-clear { padding: .5rem; font-size: .9rem; }

      table, thead, tbody, th, td, tr {
        display: block;
      }

      th {
        display: none;
      }

      td {
        border: none;
        padding: 0.75rem;
        position: relative;
      }

      td::before {
        content: attr(data-label);
        font-weight: 600;
        display: block;
        margin-bottom: 0.25rem;
        color: var(--accent-blue);
      }

      tr {
        margin-bottom: 1.5rem;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        background-color: white;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Black Hills Community Resource Hub</h1>
    <p>Accessible local services for health, wellness, and support</p>
  
  <p class="contact-subtitle">
    If any information is incorrect, please
    <a href="mailto: sens-fhes@monument.health">email corrections here.</a>
  </p></header>
<script src="resources.js"></script>
<div class="search-container" aria-hidden="false">
        <input id="resource-search" class="search-input" type="search" placeholder="Search resources (name, phone, address, description)..." aria-label="Search resources">
        <button id="search-clear" class="search-clear" type="button" aria-label="Clear search">Clear</button>
      </div>
    <main id="resource-container">
        <section>
            <h2>Dental Resources</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>
                    </tr>
                </thead>
                <tbody id="dental-table-body">
                    <!-- Dental resources will be dynamically inserted here -->
                </tbody>
            </table>
        </section>

        <section>
            <h2>Medical Resources</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>
                    </tr>
                </thead>
                <tbody id="medical-table-body">
                    <!-- Medical resources will be dynamically inserted here -->
                </tbody>
            </table>
        </section>

        <section>
            <h2>Pregnancy Resources</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>
                    </tr>
                </thead>
                <tbody id="pregnancy-table-body">
                    <!-- Pregnancy resources will be dynamically inserted here -->
                </tbody>
            </table>
              <section>
        <h2>Family Planning</h2>
        <table>
            <thead>
                <tr>
                    <th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>
                </tr>
            </thead>
            <tbody id="family-planning-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Family Education Services</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="family-education-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Adoption</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="adoption-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Foster Care Services</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="foster-care-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Breastfeeding Services</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="breastfeeding-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Car Seat Programs</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="car-seat-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Child Support Enforcement</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="child-support-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>South Dakota Department of Health Programs</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="sd-health-programs-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Youth Programs</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="youth-programs-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Foster Care Transition Resources</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="foster-transition-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Youth Hotlines</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="youth-hotlines-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Food Assistance</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="food-assistance-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Nutrition</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="nutrition-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Clothing & Household Items Assistance</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="clothing-household-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Emergency Loans</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="emergency-loans-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Housing Assistance</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="housing-assistance-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Legal Assistance</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="legal-assistance-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Utility Assistance</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="utility-assistance-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Weatherization Programs</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="weatherization-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Employment / Unemployment Services</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="employment-services-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Literacy & Continued Education</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="literacy-education-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Financial Literacy Resources</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="financial-literacy-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Mental Health & Substance Use</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="mental-health-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Crisis Intervention Services</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="crisis-intervention-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Grief Support Services</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="grief-support-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Transportation & Accessibility</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="transportation-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Driver's Licenses & ID Services</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="drivers-licensing-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Cultural & Community Groups</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="cultural-community-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Cancer Support</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="cancer-support-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Diabetes Support</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="diabetes-support-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>AA Meetings</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="aa-meetings-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>NA Meetings</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="na-meetings-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Elderly & Disability Services</h2>
        <table>
            <thead>
                <tr>
                    <th>Program</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>
                </tr>
            </thead>
            <tbody id="elderly-disability-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Pet Care & Assistance</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>            </thead>
            <tbody id="pet-care-table-body"></tbody>
        </table>
    </section>

    <section>
        <h2>Miscellaneous Hotlines</h2>
        <table>
            <thead>
                <tr>
<th>Name</th><th>Phone Number</th><th>Address/URL</th><th>Open Hours</th><th>Description</th>                </tr>
            </thead>
            <tbody id="miscellaneous-hotlines-table-body"></tbody>
        </table>
    </section>
</main>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll("#resource-container section").forEach((section, idx) => {
        const h2 = section.querySelector("h2");
        const table = section.querySelector("table");
        const tbody = section.querySelector("tbody");
        if (!h2 || !table || !tbody) return;

        // ensure tbody has an id (render script relies on these ids)
        if (!tbody.id) tbody.id = `tbody-${idx}`;

        // create toggle button reusing the .section-header style
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "section-header section-toggle";
        btn.setAttribute("aria-expanded", "true");
        btn.setAttribute("aria-controls", tbody.id);
        btn.innerHTML = `<span class="chev" aria-hidden="true">▾</span> ${h2.textContent.trim()}`;

        // replace heading text with the button (keeps semantic h2)
        h2.textContent = "";
        h2.appendChild(btn);

        btn.addEventListener("click", () => {
          const expanded = btn.getAttribute("aria-expanded") === "true";
          btn.setAttribute("aria-expanded", String(!expanded));
          table.style.display = expanded ? "none" : "";
          btn.querySelector(".chev").textContent = expanded ? "▸" : "▾";
        });
      });
      // Search functionality (supports synonyms and "Free: yes")
      const searchInput = document.getElementById("resource-search");
      const clearBtn = document.getElementById("search-clear");
      if (!searchInput) return;

      function normalize(text) {
        return (text || "").toString().toLowerCase();
      }

      // synonyms map: token -> array of alternatives to accept
      const SYNONYMS = {
        dentist: ["dentist", "dental", "dentistry"],
        dental: ["dental", "dentist", "dentistry"],
        pediatrics: ["pediatric", "pediatrics", "children"],
        childcare: ["childcare", "children"],
        phone: ["phone", "tel", "telephone"]
        // add more as needed
      };

      function buildTokenAlternatives(rawQuery) {
        const tokens = rawQuery.split(/\s+/).filter(Boolean);
        return tokens.map(t => {
          if (SYNONYMS[t]) return SYNONYMS[t];
          // split simple "name:val" tokens preserved as-is
          return [t];
        });
      }

      function filterResources(query) {
        let raw = (query || "").trim().toLowerCase();

        // detect "free: yes" or "free: y" or "free: true"
        let requireFree = false;
        const freeMatch = raw.match(/(^|\s)free\s*:\s*(yes|y|true)\b/);
        if (freeMatch) {
          requireFree = true;
          // remove that clause from the search text
          raw = raw.replace(/(^|\s)free\s*:\s*(yes|y|true)\b/g, "").trim();
        }

        // if user types just "free" treat it as free:true shorthand
        if (!requireFree && /^\s*free\s*$/i.test(query)) {
          requireFree = true;
          raw = "";
        }

        // no search tokens -> show rows (but still filter by free flag if required)
        const tokenAlternatives = raw ? buildTokenAlternatives(raw) : [];

        let anyMatch = false;
        const sections = document.querySelectorAll("#resource-container section");
        sections.forEach(section => {
          const table = section.querySelector("table");
          const tbody = section.querySelector("tbody");
          const toggle = section.querySelector(".section-toggle");
          if (!tbody) return;

          const rows = Array.from(tbody.querySelectorAll("tr"));
          let sectionHasMatch = false;

          rows.forEach(row => {
            const cellsText = Array.from(row.querySelectorAll("td"))
              .map(td => normalize(td.textContent || td.innerText))
              .join(" ");

            // free filter check
            if (requireFree && row.dataset.free !== "true") {
              row.style.display = "none";
              return;
            }

            // if there are no tokens left, it's a match
            if (tokenAlternatives.length === 0) {
              row.style.display = "";
              sectionHasMatch = true;
              return;
            }

            // check all token groups: each group requires at least one alternative to appear
            const matchedAllTokens = tokenAlternatives.every(alts =>
              alts.some(opt => cellsText.includes(opt))
            );

            row.style.display = matchedAllTokens ? "" : "none";
            if (matchedAllTokens) sectionHasMatch = true;
          });

          // show/hide table and update toggle state
          if (sectionHasMatch) {
            table.style.display = "";
            if (toggle) {
              toggle.setAttribute("aria-expanded", "true");
              const chev = toggle.querySelector(".chev");
              if (chev) chev.textContent = "▾";
            }
            anyMatch = true;
          } else {
            table.style.display = "none";
            if (toggle) {
              toggle.setAttribute("aria-expanded", "false");
              const chev = toggle.querySelector(".chev");
              if (chev) chev.textContent = "▸";
            }
          }
        });

        return anyMatch;
      }
   // initial state
      filterResources("");
      // debounce helper
      function debounce(fn, wait = 180) {
        let t;
        return (...args) => {
          clearTimeout(t);
          t = setTimeout(() => fn(...args), wait);
        };
      }

      const debouncedFilter = debounce((e) => {
        filterResources(e.target.value || "");
      }, 180);

      searchInput.addEventListener("input", debouncedFilter);

      clearBtn && clearBtn.addEventListener("click", () => {
        searchInput.value = "";
        filterResources("");
        searchInput.focus();
      });
    });
  </script>
</body>
</html>

