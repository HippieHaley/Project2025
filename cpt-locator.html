<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CPT Locator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css">
  <style>
    :root{
      --blue:#acdbf9;
      --pink:#f8c9f9;
      --ink:#333;
      --card:#fff;
    }
    *{ box-sizing:border-box; }
    body{
      font-family: Arial, sans-serif;
      background-color: var(--blue);
      color: var(--ink);
      min-height:100vh;
      margin:0;
      text-align:center;
    }

    h1{
      margin:90px 0 10px;
      font-size:2rem;
    }
    .sub{
      opacity:.9;
      margin-bottom:8px;
    }

    .mh-searchbar{
      margin: 1rem auto 1.5rem;
      padding: 1rem 1.25rem;
      background: var(--blue);
      border: 1.5px solid var(--blue);
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(190,190,190,0.13);
      display:flex; flex-wrap:wrap; align-items:center; gap:.7rem;
      width:fit-content;
      font-family: Arial, sans-serif;
    }
    .mh-searchbar label{
      font-weight:600; color:var(--ink); margin-right:.25rem;
    }
    .mh-searchbar input[type="text"]{
      font: inherit;
      font-size: 1rem;
      padding: .35em .9em;
      border: 1px solid var(--pink);
      border-radius: 7px;
      background: var(--pink);
      color: #222;
      outline: none;
      transition: border .2s, background .2s;
    }
    .mh-searchbar input[type="text"]:focus{
      border-color:#8aa9ff; background:#fff;
    }

    #results{
      padding: 0 16px 48px;
    }

    #results .meta{
      max-width: 980px;
      margin: 0 auto .5rem;
      text-align:left;
      font-size:.95rem;
    }

    #results table{
      margin: 0 auto 2rem;
      background: var(--card);
      border-radius: 16px;
      padding: 0 0 .5rem;
      box-shadow: 0 2px 16px #bbb4;
      min-width: 950px;
      max-width: 950px;
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      overflow:hidden;
    }
    #results thead th{
      background: var(--pink);
      padding: 12px 18px;
      text-align:left;
      font-weight:700;
      letter-spacing:.02em;
    }
    #results tbody td{
      padding: 10px 18px;
      text-align:left;
      font-size:1.06rem;
      background:#fff;
    }
    #results tbody tr:nth-child(even) td{ background:#f7e4fa; }

    .muted{ color:#555; font-size:.95rem; }
    .nowrap{ white-space:nowrap; }
    .kw{
      display:block;
      font-size:.85rem;
      color:#666;
      margin-top:2px;
    }

    .no-results{
      margin: 1rem auto 0;
      background: #fff;
      border-radius: 12px;
      padding: 14px 18px;
      display: inline-block;
      box-shadow: 0 2px 10px #bbb4;
    }

    @media (max-width: 1020px){
      #results table{ min-width: unset; width: 96%; }
      #results thead th:nth-child(3),
      #results thead th:nth-child(5),
      #results tbody td:nth-child(3),
      #results tbody td:nth-child(5){ display:none; } /* hide HCPCS + Modifier on narrow screens */
    }
  </style>
</head>
<body>
  <a href="./index.html" class="back-home">Back to Home</a>

  <h1>CPT Locator</h1>
  <div class="sub">Search by any combination of fields. Service search also checks keywords.</div>

  <div class="mh-searchbar" role="search" aria-label="CPT Locator search">
    <label for="search-service">Search by:</label>
    <input type="text" id="search-service" placeholder="Service / Keywords" autocomplete="off" />
    <input type="text" id="search-cpt" placeholder="CPT" autocomplete="off" />
    <input type="text" id="search-hcpcs" placeholder="HCPCS" autocomplete="off" />
    <input type="text" id="search-icd10" placeholder="ICD-10" autocomplete="off" />
    <input type="text" id="search-modifier" placeholder="Modifier" autocomplete="off" />
  </div>
  <div id="results"></div>
  <script type="module">
  // 1) Make sure catalog.js ends with:  export default procedures;
  import procedures from './catalog.js';

  const get = (id) => document.getElementById(id);

  function displayResults(results) {
    const resultsDiv = get('results');
    if (!results || results.length === 0) {
      resultsDiv.innerHTML = "<p>No results found.</p>";
      return;
    }
    let html = `
      <table style="margin:2rem auto;background:#fff;border-radius:8px;padding:1rem;box-shadow:0 2px 10px #bbb;">
        <thead>
          <tr>
            <th>Name</th>
            <th>CPT</th>
            <th>HCPCS</th>
            <th>ICD-10</th>
          </tr>
        </thead>
        <tbody>
    `;
    results.forEach(row => {
      html += `
        <tr>
          <td>${row.name}</td>
          <td>${row.cpt || ''}</td>
          <td>${row.hcpcs || ''}</td>
          <td>${row.icd10 || ''}</td>
        </tr>
      `;
    });
    html += `</tbody></table>`;
    resultsDiv.innerHTML = html;
  }

  function searchProcedures() {
    const name    = (get('search-service').value || '').toLowerCase();
    const cpt     = (get('search-cpt').value || '').toLowerCase();
    const hcpcs   = (get('search-hcpcs').value || '').toLowerCase();
    const icd10   = (get('search-icd10').value || '').toLowerCase();
    // You donâ€™t have modifiers/notes in data; read it but ignore in filter for now:
    const modifier = (get('search-modifier').value || '').toLowerCase();

    const results = procedures.filter(row => {
      const kw = (row.keywords || []).join(' ').toLowerCase();
      return (
        (!name  || row.name.toLowerCase().includes(name) || kw.includes(name)) &&
        (!cpt   || (row.cpt   || '').toLowerCase().includes(cpt)) &&
        (!hcpcs || (row.hcpcs || '').toLowerCase().includes(hcpcs)) &&
        (!icd10 || (row.icd10 || '').toLowerCase().includes(icd10))
        // modifier intentionally not used: no row.notes/row.modifier in your data
      );
    });

    displayResults(results);
  }

  // Single, simple wiring:
  ['search-service','search-cpt','search-hcpcs','search-icd10','search-modifier']
    .forEach(id => get(id).addEventListener('input', searchProcedures));

  // Show all on load
  displayResults(procedures);
</script>
</html>